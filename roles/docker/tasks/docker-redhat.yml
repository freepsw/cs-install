---
- name : Uninstall old versions
  yum:
    name: "{{ item }}"
    state: absent
  with_items:
    - docker
    - docker-common
    - container-selinux
    - docker-selinux
    - docker-engine-selinux
    - docker-engine
    - docker-ce
    - docker-ce-selinux
  become: true

# - name: Install dependencies
#   yum:
#       name={{ item }}
#       update_cache=yes
#       state=present
#   with_items: "{{ __docker_pre_packages }}"

# - name: Install pip
#   easy_install:
#       name=pip

# - name: Install docker-py
#   pip:
#     name=docker-py
#     state=present

# - name: Add docker yum repo
#   shell: "yum-config-manager --add-repo {{ __docker_repo_url }}"
#   when: __docker_package == "docker-ce"

- name: Copy docker-ce repository to /etc/yum.repos.d/
  copy:
    src: "data/{{ docker_repo_file }}"
    dest: /etc/yum.repos.d/

- name: Create temporary directory to save necessary file
  file: path="{{ remote_temp_directory }}" state=directory mode=0755

- name: Copy docker rpm file to ~/home/user directory
  copy:
    src: data/"{{ docker_rpm_file }}"
    dest: "{{ remote_temp_directory }}"

- name: Install package.
  yum:
     name: "{{ remote_temp_directory }}/{{ docker_rpm_file }}"
     state: present
